"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const __1 = require("../../..");
class Output {
    static _errorToObj(e) {
        let out = {};
        if (e instanceof __1.ServerError) {
            out = e.toJSON();
            if (out.data && out.data instanceof Error) {
                out.data = Output._errorToObj(out.data);
            }
        }
        else if (e instanceof Error) {
            out = {
                code: e.name,
                message: e.message,
                stack: e.stack,
            };
        }
        return out;
    }
    static generate(data, req, res) {
        if (data instanceof Error) {
            return {
                id: req.id || null,
                jsonrpc: req.jsonrpc || '2.0',
                error: Output._errorToObj(data),
                result: null
            };
        }
        else {
            return {
                id: req.id,
                jsonrpc: req.jsonrpc,
                result: data
            };
        }
    }
}
exports.Output = Output;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvU2VydmVyL0xpYnJhcnkvT3V0cHV0L2luZGV4LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBRUEsZ0NBQXNEO0FBRXRELE1BQWEsTUFBTTtJQUNmLE1BQU0sQ0FBQyxXQUFXLENBQUMsQ0FBYztRQUM3QixJQUFJLEdBQUcsR0FBMEIsRUFBRSxDQUFDO1FBRXBDLElBQUksQ0FBQyxZQUFZLGVBQVcsRUFBRTtZQUMxQixHQUFHLEdBQUcsQ0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDO1lBQ2pCLElBQUksR0FBRyxDQUFDLElBQUksSUFBSSxHQUFHLENBQUMsSUFBSSxZQUFZLEtBQUssRUFBRTtnQkFDdkMsR0FBRyxDQUFDLElBQUksR0FBRyxNQUFNLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQzthQUMzQztTQUNKO2FBQU0sSUFBSSxDQUFDLFlBQVksS0FBSyxFQUFFO1lBQzNCLEdBQUcsR0FBRztnQkFDRixJQUFJLEVBQUUsQ0FBQyxDQUFDLElBQUk7Z0JBQ1osT0FBTyxFQUFFLENBQUMsQ0FBQyxPQUFPO2dCQUNsQixLQUFLLEVBQUUsQ0FBQyxDQUFDLEtBQUs7YUFDakIsQ0FBQztTQUNMO1FBRUQsT0FBTyxHQUFHLENBQUM7SUFDZixDQUFDO0lBR0QsTUFBTSxDQUFDLFFBQVEsQ0FBQyxJQUFTLEVBQUUsR0FBc0IsRUFBRSxHQUFhO1FBQzVELElBQUksSUFBSSxZQUFZLEtBQUssRUFBRTtZQUN2QixPQUFPO2dCQUNILEVBQUUsRUFBRSxHQUFHLENBQUMsRUFBRSxJQUFJLElBQUk7Z0JBQ2xCLE9BQU8sRUFBRSxHQUFHLENBQUMsT0FBTyxJQUFJLEtBQUs7Z0JBQzdCLEtBQUssRUFBRSxNQUFNLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBUTtnQkFDdEMsTUFBTSxFQUFFLElBQUk7YUFDZixDQUFDO1NBQ0w7YUFBTTtZQUNILE9BQU87Z0JBQ0gsRUFBRSxFQUFFLEdBQUcsQ0FBQyxFQUFFO2dCQUNWLE9BQU8sRUFBRSxHQUFHLENBQUMsT0FBTztnQkFDcEIsTUFBTSxFQUFFLElBQUk7YUFDZixDQUFDO1NBQ0w7SUFDTCxDQUFDO0NBQ0o7QUFyQ0Qsd0JBcUNDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtSZXNwb25zZX0gZnJvbSBcImV4cHJlc3NcIjtcbmltcG9ydCB7UlBDfSBmcm9tIFwiLi4vLi4vLi5cIjtcbmltcG9ydCB7U2VydmVyRXJyb3IsIFNlcnZlckVycm9ySnNvbn0gZnJvbSBcIi4uLy4uLy4uXCI7XG5cbmV4cG9ydCBjbGFzcyBPdXRwdXQge1xuICAgIHN0YXRpYyBfZXJyb3JUb09iaihlOiBFcnJvciB8IGFueSkge1xuICAgICAgICBsZXQgb3V0OiBTZXJ2ZXJFcnJvckpzb24gfCBhbnkgPSB7fTtcblxuICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIFNlcnZlckVycm9yKSB7XG4gICAgICAgICAgICBvdXQgPSBlLnRvSlNPTigpO1xuICAgICAgICAgICAgaWYgKG91dC5kYXRhICYmIG91dC5kYXRhIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBvdXQuZGF0YSA9IE91dHB1dC5fZXJyb3JUb09iaihvdXQuZGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoZSBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgICAgICBvdXQgPSB7XG4gICAgICAgICAgICAgICAgY29kZTogZS5uYW1lLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGUubWVzc2FnZSxcbiAgICAgICAgICAgICAgICBzdGFjazogZS5zdGFjayxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH1cblxuICAgIHN0YXRpYyBnZW5lcmF0ZShkYXRhOiBFcnJvciwgcmVxOiBSUEMuUmVxdWVzdC5JRGF0YSwgcmVzOiBSZXNwb25zZSlcbiAgICBzdGF0aWMgZ2VuZXJhdGUoZGF0YTogYW55LCByZXE6IFJQQy5SZXF1ZXN0LklEYXRhLCByZXM6IFJlc3BvbnNlKTogUlBDLlJlc3BvbnNlLklEYXRhIHtcbiAgICAgICAgaWYgKGRhdGEgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBpZDogcmVxLmlkIHx8IG51bGwsXG4gICAgICAgICAgICAgICAganNvbnJwYzogcmVxLmpzb25ycGMgfHwgJzIuMCcsXG4gICAgICAgICAgICAgICAgZXJyb3I6IE91dHB1dC5fZXJyb3JUb09iaihkYXRhKSBhcyBhbnksXG4gICAgICAgICAgICAgICAgcmVzdWx0OiBudWxsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBpZDogcmVxLmlkLFxuICAgICAgICAgICAgICAgIGpzb25ycGM6IHJlcS5qc29ucnBjLFxuICAgICAgICAgICAgICAgIHJlc3VsdDogZGF0YVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiJdfQ==